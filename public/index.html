<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Publitas Front-end Code Challenge</title>
    <script type="module" crossorigin>var M=Object.defineProperty;var f=s=>{throw TypeError(s)};var y=(s,t,e)=>t in s?M(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var d=(s,t,e)=>y(s,typeof t!="symbol"?t+"":t,e),p=(s,t,e)=>t.has(s)||f("Cannot "+e);var l=(s,t,e)=>(p(s,t,"read from private field"),e?e.call(s):t.get(s)),m=(s,t,e)=>t.has(s)?f("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e),r=(s,t,e,n)=>(p(s,t,"write to private field"),n?n.call(s,e):t.set(s,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}})();const E=(s,t,e,n)=>{if(s<e&&t<n)return{width:s,height:t};const o=e/s,i=n/t,a=Math.min(o,i);return{width:Math.round(s*a),height:Math.round(t*a)}},X=(s,t,e,n,o)=>{const i=n*e,a=n/2-s/2+i,w=o/2-t/2;return{x:a,y:w}},L=(s,t,e,n,o)=>{let i=s-t-e+n;return i>0&&(i=0),i<o&&(i=o),i};var u,c,h,g;class I{constructor(t,e){d(this,"canvas");d(this,"context");d(this,"imagesSources");d(this,"images");m(this,u);m(this,c);m(this,h);m(this,g);d(this,"handleMouseDown",t=>{r(this,c,"dragging");const e=this.canvas;e.style.cursor="grabbing";const n=t.type==="mousedown"?t.clientX:t.touches[0].clientX;r(this,u,n-e.getBoundingClientRect().left)});var n;this.canvas=t,this.context=(n=this.canvas)==null?void 0:n.getContext("2d"),r(this,c,"idle"),this.imagesSources=e,this.images=[],r(this,u,0),r(this,h,0),r(this,g,0),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this)}loadImage(t){return new Promise((e,n)=>{const o=new Image;o.src=t,o.onload=()=>e(o),o.onerror=()=>n(new Error(`Failed to load image: ${t}`))})}async setImages(){const t=this.imagesSources.map(n=>this.loadImage(n)),e=await Promise.all(t);this.images=e}drawImages(){const t=this.canvas,e=this.context;!e||!t||this.images.forEach((n,o)=>{const{width:i,height:a}=E(n.width,n.height,t.width,t.height),{x:w,y:v}=X(i,a,o,t.width,t.height);e==null||e.drawImage(n,w,v,i,a)})}draw(t=0){const e=this.canvas,n=this.context;!n||!e||(n.clearRect(0,0,e.width,e.height),n.fillStyle="#000",n.fillRect(0,0,e.width,e.height),n.save(),n.translate(t,0),this.drawImages(),n.restore())}handleMouseUp(){r(this,c,"idle"),this.canvas.style.cursor="grab",r(this,g,l(this,h))}get maxTranslateX(){return-1*(this.images.length*this.canvas.width-this.canvas.width)}handleMouseMove(t){if(l(this,c)!=="dragging")return;const e=t.type==="mousemove"?t.clientX:t.touches[0].clientX;r(this,h,L(e,l(this,u),this.canvas.getBoundingClientRect().left,l(this,g),this.maxTranslateX)),requestAnimationFrame(()=>this.draw(l(this,h)))}async init(){if(await this.setImages(),!this.canvas)throw new Error("Failed to find canvas element!");const t=this.canvas;t.style.cursor="grab",t.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp),t.addEventListener("touchstart",this.handleMouseDown),window.addEventListener("touchmove",this.handleMouseMove),window.addEventListener("touchend",this.handleMouseUp),this.draw()}}u=new WeakMap,c=new WeakMap,h=new WeakMap,g=new WeakMap;const b=["https://placedog.net/640/400","https://placedog.net/740/500","https://placedog.net/400/600","https://placedog.net/340/340"];window.addEventListener("load",()=>{const s=document.querySelector("#carousel");new I(s,b).init()});</script>
    <style rel="stylesheet" crossorigin>:root{font-family:system-ui,Avenir,Helvetica,Arial,sans-serif;line-height:1.5;font-weight:400;color-scheme:light dark;color:#ffffffde;background-color:#242424;font-synthesis:none;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*{box-sizing:border-box}html,body{min-width:100%;min-height:100%}body{margin:0;padding:0}main{display:flex;flex-direction:column;place-items:center}h1{font-size:3.2em;line-height:1.1}#carousel{width:600px;height:400px;border:1px solid #212121}@media screen and (max-width: 768px){body{padding:40px}#carousel{width:100%;max-width:100%;height:auto}}@media (prefers-color-scheme: light){:root{color:#213547;background-color:#fff}}</style>
  </head>
  <body>
    <main>
      <h1>Publitas Front-end Code Challenge</h1>
      <canvas id="carousel" width="640" height="400"></canvas>
      <p>Drag to change image</p>
    </main>
  </body>
</html>
